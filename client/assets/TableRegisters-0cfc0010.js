import{a as b,M as C}from"./ModalComponent-5f57c733.js";import{a as M}from"./apiAddFile-f4ff73f2.js";import{_ as E,r as i,o as d,c as y,a as o,w as l,f as g,d as S,b as e,F as A,g as I,e as u,h as p,v as f}from"./index-5b78de0a.js";async function O(){try{return await b("/files/loadfile",{method:"get"})}catch(t){return{error:t,serverMessage:"Server not available",isServerAvailable:!1}}}async function D(t){try{return await b("/files/loadfile",{method:"put",data:t})}catch(a){return{error:a,serverMessage:"Server not available",isServerAvailable:!1}}}async function N(t){try{return await b("/files/loadfile",{method:"delete",data:t})}catch(a){return{error:a,serverMessage:"Server not available",isServerAvailable:!1}}}const T={components:{ModalComponent:C},mounted(){this.getRegisters()},data(){return{records:[],hasRegisters:!1,overlay:!1,isErrorServer:!1,modalTitle:"Signup successful",modalBody:"Server not available"}},methods:{async getRegisters(){try{this.overlay=!0;const t=await O();if(this.overlay=!1,t.isServerAvailable===!1){this.modalBody=t.serverMessage,this.isErrorServer=!0;return}t.data.isSuccessful&&(t.data.allRegisters.length===0?this.hasRegisters=!1:(this.hasRegisters=!0,this.records=t.data.allRegisters))}catch{}},agregarItem(){this.records.push({userId:"",username:"",date:"",punchIn:"",punchOut:""})},async saveUpdateRow(t){const a=JSON.parse(JSON.stringify(t));if(a._id){this.overlay=!0;const s=await D(a);if(this.overlay=!1,s.isServerAvailable===!1){this.modalBody=s.serverMessage,this.isErrorServer=!0;return}s.data.isSuccessful?this.records=s.data.updatedRegisters:(this.modalBody="Unexpected error, please try again",this.isErrorServer=!0)}else{this.overlay=!0;const s=await M(a);if(this.overlay=!1,s.isServerAvailable===!1){this.modalBody=s.serverMessage,this.isErrorServer=!0;return}s.data.isSuccessful?this.records=s.data.allRegisters:(this.modalBody="Unexpected error, please try again",this.isErrorServer=!0)}},async deleteRow(t){const a=JSON.parse(JSON.stringify(t));this.overlay=!0;const s=await N(a);if(this.overlay=!1,s.isServerAvailable===!1){this.modalBody=s.serverMessage,this.isErrorServer=!0;return}if(s.data.isSuccessful){const h=this.records.indexOf(t);h>-1&&this.records.splice(h,1)}else this.modalBody="Unexpected error, please try again",this.isErrorServer=!0}}},F={class:"container py-10"},J=e("h3",{class:"py-3 text-center text-red-darken-2"},"Registers",-1),j=e("thead",null,[e("tr",{class:"border"},[e("th",{class:"text-left"},"User ID"),e("th",{class:"text-left"},"Username"),e("th",{class:"text-left"},"Date"),e("th",{class:"text-left"},"Punch In"),e("th",{class:"text-left"},"Punch Out"),e("th",{class:"text-left"},"Save"),e("th",{class:"text-left"},"Delete")])],-1),G=["onUpdate:modelValue"],L=["onUpdate:modelValue"],P=["onUpdate:modelValue"],z=["onUpdate:modelValue"],q=["onUpdate:modelValue"],H=e("p",{class:"sencundary text-grey-darken-1"},"To edit a row click over the value or add a new row",-1),K=e("h3",{class:"text-red-darken-2 text-center"}," There's no registers ",-1),Q={class:"text-center"};function W(t,a,s,h,c,v){const k=i("v-progress-circular"),R=i("v-overlay"),_=i("v-btn"),U=i("v-table"),m=i("v-col"),x=i("v-row"),w=i("v-card"),V=i("router-link"),B=i("ModalComponent");return d(),y("section",F,[o(R,{"model-value":c.overlay,class:"align-center justify-center",persistent:""},{default:l(()=>[o(k,{color:"red-darken-2",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),o(x,{cols:"12",justify:"center",class:"my-10"},{default:l(()=>[o(m,{cols:"11",sm:"10",md:"10",lg:"10",xl:"10"},{default:l(()=>[c.hasRegisters?(d(),g(w,{key:0},{default:l(()=>[J,o(U,{"fixed-header":""},{default:l(()=>[j,e("tbody",null,[(d(!0),y(A,null,I(c.records,r=>(d(),y("tr",{key:r._id},[e("td",null,[p(e("input",{class:"table-input","onUpdate:modelValue":n=>r.userId=n},null,8,G),[[f,r.userId]])]),e("td",null,[p(e("input",{class:"table-input","onUpdate:modelValue":n=>r.username=n},null,8,L),[[f,r.username]])]),e("td",null,[p(e("input",{class:"table-input","onUpdate:modelValue":n=>r.date=n},null,8,P),[[f,r.date]])]),e("td",null,[p(e("input",{class:"table-input","onUpdate:modelValue":n=>r.punchIn=n},null,8,z),[[f,r.punchIn]])]),e("td",null,[p(e("input",{class:"table-input","onUpdate:modelValue":n=>r.punchOut=n},null,8,q),[[f,r.punchOut]])]),e("td",null,[o(_,{class:"primary",onClick:n=>v.saveUpdateRow(r)},{default:l(()=>[u("Save")]),_:2},1032,["onClick"])]),e("td",null,[o(_,{class:"secondary",onClick:n=>v.deleteRow(r)},{default:l(()=>[u("Delete")]),_:2},1032,["onClick"])])]))),128))])]),_:1}),o(x,{justify:"between",class:"ma-2"},{default:l(()=>[o(m,{cols:"12",sm:"6"},{default:l(()=>[H]),_:1}),o(m,{cols:"12",sm:"6"},{default:l(()=>[o(_,{class:"sencundary",onClick:v.agregarItem},{default:l(()=>[u("ADD")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})):S("",!0),!c.hasRegisters&&!c.isErrorServer?(d(),g(w,{key:1,class:"pa-5"},{default:l(()=>[K,e("p",Q,[u(" To create a table of registers go to "),o(V,{to:"/readFile",class:"text-red-darken-2 text-decoration-underline"},{default:l(()=>[u(" Load file ")]),_:1})])]),_:1})):S("",!0)]),_:1})]),_:1}),c.isErrorServer?(d(),g(B,{key:0,"modal-title":"System message","modal-body":c.modalBody},null,8,["modal-body"])):S("",!0)])}const $=E(T,[["render",W]]);export{$ as default};
