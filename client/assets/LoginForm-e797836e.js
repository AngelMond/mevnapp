import{a as k,M as C}from"./ModalComponent-5f57c733.js";import{_ as V,r as o,o as d,c as f,a as s,w as r,f as I,d as v,b as u,e as B}from"./index-5b78de0a.js";async function E(a){try{return(await k("/users/login",{method:"post",data:a})).data}catch(e){return{error:e,serverMessage:"Server not available",isServerAvailable:!1}}}const M={components:{ModalComponent:C},mounted(){this.handleGetToken()},data(){return{username:"",password:"",overlay:!1,isLoginSuccessful:!1,hasExistingUser:!1,isErrorServer:!1,areCredentialsIncorrect:!1,isSessionToken:!1}},methods:{async submitForm(a){try{a.preventDefault();const e={username:this.username,password:this.password};this.overlay=!0;const n=await E(e);if(this.overlay=!1,n.isServerAvailable===!1){this.modalBody=n.serverMessage,this.isErrorServer=!0;return}if(!n.data.isSuccessful)this.areCredentialsIncorrect=!0;else if(n.data.isSuccessful){const{user:m,userId:t,token:c}=n.data;this.areCredentialsIncorrect=!1,this.isSuccessful=!0,window.sessionStorage.setItem("user",m),window.sessionStorage.setItem("userId",t),window.sessionStorage.setItem("token",c),this.$router.push("/")}}catch(e){console.error(e)}},handleGetToken(){}}},U={class:"mt-100 main-content"},j=u("h1",{class:"text-center text-my-red"},"Log in",-1),F={class:""},L={key:0,class:"text-red"};function N(a,e,n,m,t,c){const y=o("v-progress-circular"),h=o("v-overlay"),_=o("v-col"),i=o("v-row"),p=o("v-text-field"),w=o("v-btn"),g=o("v-card-text"),b=o("v-container"),S=o("v-card"),x=o("ModalComponent");return d(),f("section",U,[s(h,{"model-value":t.overlay,class:"align-center justify-center",persistent:""},{default:r(()=>[s(y,{color:"red-darken-2",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),s(i,{justify:"center"},{default:r(()=>[s(_,{cols:"10",sm:"8",md:"6",lg:"3",xl:"3"},{default:r(()=>[s(S,{class:"rounded-lg pa-3"},{default:r(()=>[s(i,{justify:"center"},{default:r(()=>[s(_,{cols:"6",class:"justify-center"},{default:r(()=>[j]),_:1})]),_:1}),s(b,null,{default:r(()=>[u("div",F,[s(g,null,{default:r(()=>[u("form",{onSubmit:e[2]||(e[2]=(...l)=>c.submitForm&&c.submitForm(...l))},[s(p,{modelValue:t.username,"onUpdate:modelValue":e[0]||(e[0]=l=>t.username=l),label:"Username",required:""},null,8,["modelValue"]),s(p,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=l=>t.password=l),label:"Password",required:"",type:"password"},null,8,["modelValue"]),t.areCredentialsIncorrect?(d(),f("p",L,"Username or password incorrect")):v("",!0),s(i,{class:"justify-center pe-3 py-2"},{default:r(()=>[s(w,{class:"btn mt-2",type:"submit"},{default:r(()=>[B("Continue")]),_:1})]),_:1})],32)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),t.isErrorServer||t.hasExistingUser?(d(),I(x,{key:0,"modal-title":"System message","modal-body":a.modalBody},null,8,["modal-body"])):v("",!0)])}const q=V(M,[["render",N]]);export{q as default};
